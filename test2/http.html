<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>

    <button onclick="test()">点我测试 </button>
    <h1>😀F11, See the console!😀</h1>
</body>

</html>
<script>


    /*
    1. If you want to use this,please notice CROS,go https://wicg.github.io/private-network-access/ for detail.
    2. Now, you can open the url 'chrome://flags/#block-insecure-private-network-requests' at chrome or edge, set it disable, for avoid CROS problems
    */

    let sendArr = [

        // {
        //     Id: "",
        //     MsgType: "GetPrintInfo"
        // },
        // {
        //     Id: "",
        //     MsgType: "AddOnePrintConfig",
        //     Data: {
        //         Name: "Hi",
        //         PrinterName: "Microsoft Print to PDF",
        //         TopMargin: 0,
        //         BottomMargin: 0,
        //         LeftMargin: 0,
        //         RightMargin: 0,
        //         Orientation: "",
        //         PaperName: "A4",
        //         SaveType:"1111",
        //         PaperWidthInmm:210,
        //         PaperHeightInmm:297
        //     }
        // },
        // {
        //     Id: "",
        //     MsgType: "DelOnePrintConfig",
        //     Data: 1//change it
        // },
        // {
        //     Id: "",
        //     MsgType: "UpdateOnePrintConfig",
        //     Data: {
        //         Name: "test213",
        //         PrinterName: "导出为WPS PDF",
        //         TopMargin: 0,
        //         BottomMargin: 1,
        //         LeftMargin: 2,
        //         RightMargin: 2,
        //         Orientation: "横向",
        //         PaperName: "A4"
        //     }
        // },


        // {
        //     Id: "",
        //     MsgType: "GetPrintConfigs"
        // },
        {
            Id: "",
            MsgType: "ToPrint",
            Data: [
                {
                    PageUrl: "https://www.bing.com",
                    ConfigName: "Hi",
                    PrintMode: "LoadAchieve"
                }
            ]
        },
        // {
        //     Id: "",
        //     MsgType: "GetPrintedPages",
        //     Data: {
        //         Size: 20,
        //         Page: 1
        //     }
        // },
        // {
        //     Id: "",
        //     MsgType: "InsertOrUpdateWebsocketUrl",
        //     Data: "ws://127.0.0.1:8001"
        // },
        // {
        //     Id: "GetWebsocketUrl",
        //     MsgType: "GetWebsocketUrl"
        // }

    ]


    function test() {
        sendArr.forEach(e => {

            fetch("http://127.0.0.1:8847/PrintController/Print", {//Your webprinttool url

                method: "POST",
                body: JSON.stringify(e)
            }).then(res => res.json()).then(data => {


                console.log(data)
            })

        })
    }


</script>